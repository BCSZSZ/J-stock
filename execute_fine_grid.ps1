# 细化参数网格回测脚本 (Fine-grain Parameter Grid)
# 生成时间: 2026-02-22
# 总回测数: 405个 (81策略 × 5年)
# 预期耗时: ~25-30分钟 (4 workers)

cd e:\Code\AI-stock\J-stock

Write-Host "=== 开始执行细化参数网格回测 ===" -ForegroundColor Cyan
Write-Host "总策略数: 81" -ForegroundColor Green
Write-Host "总回测数: 405" -ForegroundColor Green
Write-Host "预期耗时: 25-30分钟" -ForegroundColor Yellow
Write-Host ""

$startTime = Get-Date

e:.venv\Scripts\python.exe main.py evaluate `
  --mode annual `
  --years 2021 2022 2023 2024 2025 `
  --entry-strategies MACDCrossoverStrategy `
  --exit-strategies `
    MVX_N8_R3p4_T1p5_D18_B19p5 MVX_N8_R3p4_T1p6_D18_B19p5 MVX_N8_R3p4_T1p7_D18_B19p5 MVX_N8_R3p5_T1p5_D18_B19p5 MVX_N8_R3p5_T1p6_D18_B19p5 MVX_N8_R3p5_T1p7_D18_B19p5 MVX_N8_R3p6_T1p5_D18_B19p5 MVX_N8_R3p6_T1p6_D18_B19p5 MVX_N8_R3p6_T1p7_D18_B19p5 MVX_N9_R3p4_T1p5_D18_B19p5 MVX_N9_R3p4_T1p6_D18_B19p5 MVX_N9_R3p4_T1p7_D18_B19p5 MVX_N9_R3p5_T1p5_D18_B19p5 MVX_N9_R3p5_T1p6_D18_B19p5 MVX_N9_R3p5_T1p7_D18_B19p5 MVX_N9_R3p6_T1p5_D18_B19p5 MVX_N9_R3p6_T1p6_D18_B19p5 MVX_N9_R3p6_T1p7_D18_B19p5 MVX_N10_R3p4_T1p5_D18_B19p5 MVX_N10_R3p4_T1p6_D18_B19p5 MVX_N10_R3p4_T1p7_D18_B19p5 MVX_N10_R3p5_T1p5_D18_B19p5 MVX_N10_R3p5_T1p6_D18_B19p5 MVX_N10_R3p5_T1p7_D18_B19p5 MVX_N10_R3p6_T1p5_D18_B19p5 MVX_N10_R3p6_T1p6_D18_B19p5 MVX_N10_R3p6_T1p7_D18_B19p5 MVX_N8_R3p4_T1p5_D18_B20p0 MVX_N8_R3p4_T1p6_D18_B20p0 MVX_N8_R3p4_T1p7_D18_B20p0 MVX_N8_R3p5_T1p5_D18_B20p0 MVX_N8_R3p5_T1p6_D18_B20p0 MVX_N8_R3p5_T1p7_D18_B20p0 MVX_N8_R3p6_T1p5_D18_B20p0 MVX_N8_R3p6_T1p6_D18_B20p0 MVX_N8_R3p6_T1p7_D18_B20p0 MVX_N9_R3p4_T1p5_D18_B20p0 MVX_N9_R3p4_T1p6_D18_B20p0 MVX_N9_R3p4_T1p7_D18_B20p0 MVX_N9_R3p5_T1p5_D18_B20p0 MVX_N9_R3p5_T1p6_D18_B20p0 MVX_N9_R3p5_T1p7_D18_B20p0 MVX_N9_R3p6_T1p5_D18_B20p0 MVX_N9_R3p6_T1p6_D18_B20p0 MVX_N9_R3p6_T1p7_D18_B20p0 MVX_N10_R3p4_T1p5_D18_B20p0 MVX_N10_R3p4_T1p6_D18_B20p0 MVX_N10_R3p4_T1p7_D18_B20p0 MVX_N10_R3p5_T1p5_D18_B20p0 MVX_N10_R3p5_T1p6_D18_B20p0 MVX_N10_R3p5_T1p7_D18_B20p0 MVX_N10_R3p6_T1p5_D18_B20p0 MVX_N10_R3p6_T1p6_D18_B20p0 MVX_N10_R3p6_T1p7_D18_B20p0 MVX_N8_R3p4_T1p5_D18_B20p5 MVX_N8_R3p4_T1p6_D18_B20p5 MVX_N8_R3p4_T1p7_D18_B20p5 MVX_N8_R3p5_T1p5_D18_B20p5 MVX_N8_R3p5_T1p6_D18_B20p5 MVX_N8_R3p5_T1p7_D18_B20p5 MVX_N8_R3p6_T1p5_D18_B20p5 MVX_N8_R3p6_T1p6_D18_B20p5 MVX_N8_R3p6_T1p7_D18_B20p5 MVX_N9_R3p4_T1p5_D18_B20p5 MVX_N9_R3p4_T1p6_D18_B20p5 MVX_N9_R3p4_T1p7_D18_B20p5 MVX_N9_R3p5_T1p5_D18_B20p5 MVX_N9_R3p5_T1p6_D18_B20p5 MVX_N9_R3p5_T1p7_D18_B20p5 MVX_N9_R3p6_T1p5_D18_B20p5 MVX_N9_R3p6_T1p6_D18_B20p5 MVX_N9_R3p6_T1p7_D18_B20p5 MVX_N10_R3p4_T1p5_D18_B20p5 MVX_N10_R3p4_T1p6_D18_B20p5 MVX_N10_R3p4_T1p7_D18_B20p5 MVX_N10_R3p5_T1p5_D18_B20p5 MVX_N10_R3p5_T1p6_D18_B20p5 MVX_N10_R3p5_T1p7_D18_B20p5 MVX_N10_R3p6_T1p5_D18_B20p5 MVX_N10_R3p6_T1p6_D18_B20p5 MVX_N10_R3p6_T1p7_D18_B20p5

$endTime = Get-Date
$duration = $endTime - $startTime

Write-Host ""
Write-Host "=== 回测完成 ===" -ForegroundColor Green
Write-Host "耗时: $($duration.TotalMinutes) 分钟" -ForegroundColor Cyan
Write-Host "结果已保存到 Google Drive" -ForegroundColor Green
