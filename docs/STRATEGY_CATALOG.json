{
  "catalog_version": "1.0",
  "generated_date": "2026-01-14",
  "description": "J-Stock Analyzer 现有策略集合 - 用于AI策略生成参考",
  
  "strategy_architecture": {
    "entry_strategies": 3,
    "exit_strategies": 3,
    "total_combinations": 9,
    "signal_execution_model": "T日信号在T+1日开盘价执行",
    "lot_size_model": "支持配置化最小购买单位（默认100股，REIT类1股）"
  },
  
  "available_data_sources": {
    "price_data": {
      "fields": ["Open", "High", "Low", "Close", "Volume"],
      "frequency": "daily",
      "source": "JQuants API"
    },
    "technical_indicators": {
      "trend": ["SMA_20", "SMA_50", "EMA_20", "EMA_200"],
      "momentum": ["RSI", "MACD", "MACD_Signal", "MACD_Hist"],
      "volatility": ["ATR", "Bollinger_Upper", "Bollinger_Lower"],
      "volume": ["Volume_SMA_20"]
    },
    "institutional_data": {
      "fields": ["ForeignBuyValue", "ForeignSellValue", "ForeignNetValue", "ForeignBuyVolume", "ForeignSellVolume"],
      "frequency": "weekly",
      "description": "外资机构交易数据"
    },
    "fundamental_data": {
      "fields": ["ROE", "NetIncome", "TotalAssets", "EPS", "OperatingIncome"],
      "frequency": "quarterly",
      "description": "财务报表数据"
    },
    "metadata": {
      "fields": ["NextEarningsDate", "Sector", "MarketCap"],
      "description": "股票元数据"
    }
  },
  
  "entry_strategies": [
    {
      "name": "SimpleScorerStrategy",
      "type": "entry",
      "category": "multi-factor",
      "description": "基于综合打分的入场策略，使用平衡的四维度权重",
      
      "core_logic": {
        "approach": "计算技术、机构、基本面、波动性的加权综合分数",
        "buy_condition": "综合分数 >= 65分",
        "weights": {
          "technical": 0.40,
          "institutional": 0.30,
          "fundamental": 0.20,
          "volatility": 0.10
        }
      },
      
      "scoring_dimensions": {
        "technical": {
          "components": ["趋势强度", "动量指标", "支撑阻力位"],
          "weight": 0.40
        },
        "institutional": {
          "components": ["外资净流入", "机构持仓变化"],
          "weight": 0.30
        },
        "fundamental": {
          "components": ["ROE", "盈利增长", "财务健康度"],
          "weight": 0.20
        },
        "volatility": {
          "components": ["ATR", "波动率评分"],
          "weight": 0.10
        }
      },
      
      "risk_controls": {
        "earnings_avoidance": {
          "enabled": true,
          "description": "财报临近时降低分数20%",
          "distance_threshold": "7天内"
        }
      },
      
      "parameters": {
        "buy_threshold": {
          "default": 65.0,
          "type": "float",
          "description": "买入分数阈值"
        }
      },
      
      "output_metadata": {
        "score": "综合分数",
        "breakdown": "各维度分数明细",
        "earnings_risk": "是否有财报风险"
      }
    },
    
    {
      "name": "EnhancedScorerStrategy",
      "type": "entry",
      "category": "multi-factor",
      "description": "增强版综合打分策略，更重视机构流向和财报风险",
      
      "core_logic": {
        "approach": "与SimpleScorerStrategy相同，但调整权重更重视机构行为",
        "buy_condition": "综合分数 >= 65分",
        "weights": {
          "technical": 0.35,
          "institutional": 0.35,
          "fundamental": 0.20,
          "volatility": 0.10
        }
      },
      
      "key_differences_from_simple": [
        "机构流向权重从30%提升到35%",
        "技术指标权重从40%降至35%",
        "财报风险采用渐进式惩罚（1天内-50%，3天内-30%，7天内-15%）"
      ],
      
      "risk_controls": {
        "earnings_avoidance": {
          "enabled": true,
          "description": "财报临近时采用渐进式惩罚",
          "penalty_schedule": {
            "1_day": -0.50,
            "3_days": -0.30,
            "7_days": -0.15
          }
        }
      },
      
      "parameters": {
        "buy_threshold": {
          "default": 65.0,
          "type": "float",
          "description": "买入分数阈值"
        }
      }
    },
    
    {
      "name": "MACDCrossoverStrategy",
      "type": "entry",
      "category": "technical-pure",
      "description": "纯技术指标策略，基于MACD金叉信号",
      
      "core_logic": {
        "approach": "检测MACD柱状图由负转正（金叉）",
        "buy_condition": "MACD_Hist从负数变为正数",
        "confirmations": [
          "成交量放大（可选）",
          "价格在EMA200上方（可选）"
        ]
      },
      
      "indicators_used": {
        "primary": "MACD_Hist",
        "confirmation_1": "Volume / Volume_SMA_20",
        "confirmation_2": "Close vs EMA_200"
      },
      
      "signal_generation": {
        "base_confidence": 0.70,
        "volume_surge_bonus": "+0.10 (if volume > 1.2x avg)",
        "volume_weak_penalty": "-0.05 (if volume normal)",
        "uptrend_bonus": "+0.10 (if price > EMA200)",
        "downtrend_penalty": "-0.15 (if price < EMA200)"
      },
      
      "parameters": {
        "confirm_with_volume": {
          "default": true,
          "type": "bool",
          "description": "是否需要成交量确认"
        },
        "confirm_with_trend": {
          "default": true,
          "type": "bool",
          "description": "是否需要趋势确认"
        },
        "min_confidence": {
          "default": 0.6,
          "type": "float",
          "description": "最低置信度阈值"
        }
      },
      
      "advantages": [
        "纯技术指标，无需基本面数据",
        "反应灵敏，捕捉动量转换",
        "适合趋势市场"
      ],
      
      "limitations": [
        "震荡市场容易产生假信号",
        "不考虑机构流向和基本面"
      ]
    }
  ],
  
  "exit_strategies": [
    {
      "name": "ATRExitStrategy",
      "type": "exit",
      "category": "technical-pure",
      "description": "基于ATR的4层技术退出策略",
      
      "core_logic": {
        "approach": "使用ATR动态计算止损和追踪止盈位",
        "layers": [
          "P0: Hard Stop Loss",
          "P1: Trailing Stop",
          "P2: Momentum Exhaustion",
          "P3: Trend Breakdown"
        ]
      },
      
      "exit_layers": {
        "P0_HardStop": {
          "priority": 1,
          "condition": "Close < (Entry - 2*ATR)",
          "confidence": 1.0,
          "description": "硬止损，防止大额亏损"
        },
        "P1_TrailingStop": {
          "priority": 2,
          "condition": "Close < (Peak - 3*ATR)",
          "confidence": 0.9,
          "description": "追踪止盈，保护已有利润"
        },
        "P2_MomentumExhaustion": {
          "priority": 3,
          "condition": "RSI > 70 AND Close < EMA_20",
          "confidence": 0.8,
          "description": "动能衰竭，超买后破位"
        },
        "P3_TrendBreakdown": {
          "priority": 4,
          "condition": "多重技术指标破坏（EMA20下穿EMA50等）",
          "confidence": 0.85,
          "description": "趋势反转信号"
        }
      },
      
      "parameters": {
        "atr_stop_multiplier": {
          "default": 2.0,
          "type": "float",
          "description": "Hard Stop的ATR倍数"
        },
        "atr_trail_multiplier": {
          "default": 3.0,
          "type": "float",
          "description": "Trailing Stop的ATR倍数"
        },
        "rsi_overbought": {
          "default": 70.0,
          "type": "float",
          "description": "RSI超买阈值"
        }
      },
      
      "advantages": [
        "动态适应市场波动",
        "多层防护机制",
        "纯技术指标，执行简单"
      ]
    },
    
    {
      "name": "ScoreBasedExitStrategy",
      "type": "exit",
      "category": "multi-factor",
      "description": "基于打分衰减的退出策略，监控综合质量变化",
      
      "core_logic": {
        "approach": "持续计算当前综合分数，与入场分数比较",
        "sell_condition": "当前分数 < (入场分数 - 15分)"
      },
      
      "scoring_model": {
        "weights": {
          "technical": 0.40,
          "institutional": 0.30,
          "fundamental": 0.20,
          "volatility": 0.10
        },
        "description": "与SimpleScorerStrategy使用相同权重"
      },
      
      "exit_logic": {
        "score_buffer": 15.0,
        "confidence_calculation": "min(score_decay / 50, 1.0)",
        "metadata_tracked": ["current_score", "entry_score", "decay", "breakdown"]
      },
      
      "parameters": {
        "score_buffer": {
          "default": 15.0,
          "type": "float",
          "description": "分数衰减阈值"
        },
        "weights": {
          "default": "Simple权重",
          "type": "dict",
          "description": "打分权重配置"
        }
      },
      
      "best_paired_with": [
        "SimpleScorerStrategy",
        "EnhancedScorerStrategy"
      ],
      
      "advantages": [
        "与入场策略逻辑一致",
        "全面监控多维度质量变化",
        "避免单一技术指标误判"
      ]
    },
    
    {
      "name": "LayeredExitStrategy",
      "type": "exit",
      "category": "hybrid",
      "description": "6层混合退出策略，结合技术指标和综合打分",
      
      "core_logic": {
        "approach": "从高优先级到低优先级检查6层退出条件",
        "configurable": "可选择是否使用Score Utils"
      },
      
      "exit_layers": {
        "Layer1_Emergency": {
          "priority": 1,
          "condition": "机构大举撤离（外资连续净卖出）",
          "confidence": 1.0,
          "uses_score_utils": true
        },
        "Layer2_TrendBreakdown": {
          "priority": 2,
          "condition": "技术趋势破坏（EMA20下穿EMA50等）",
          "confidence": 0.9,
          "uses_score_utils": true
        },
        "Layer3_MarketDeterioration": {
          "priority": 3,
          "condition": "市场状况恶化（对比入场时）",
          "confidence": 0.88,
          "uses_score_utils": true
        },
        "Layer4_MultiWeakness": {
          "priority": 4,
          "condition": "多维度弱化（可选使用Score Utils）",
          "confidence": 0.85,
          "uses_score_utils": "optional"
        },
        "Layer5_TrailingStop": {
          "priority": 5,
          "condition": "Close < (Peak - 2*ATR)",
          "confidence": 0.8,
          "uses_score_utils": false
        },
        "Layer6_TimeReview": {
          "priority": 6,
          "condition": "持仓超过90天且分数低于入场（可选）",
          "confidence": 0.75,
          "uses_score_utils": "optional"
        }
      },
      
      "parameters": {
        "use_score_utils": {
          "default": true,
          "type": "bool",
          "description": "是否使用Score Utils（Layer 4和6）"
        },
        "trailing_atr_mult": {
          "default": 2.0,
          "type": "float",
          "description": "Trailing Stop的ATR倍数"
        },
        "review_days": {
          "default": 90,
          "type": "int",
          "description": "审查周期（天）"
        }
      },
      
      "advantages": [
        "最全面的退出保护",
        "可配置灵活度",
        "结合技术和基本面"
      ],
      
      "complexity": "high",
      "recommended_for": "高级用户和长期持仓"
    }
  ],
  
  "scoring_utils_library": {
    "description": "共享的打分和检测工具集",
    "location": "src/analysis/scoring_utils.py",
    
    "functions": {
      "calculate_composite_score": {
        "description": "计算四维度综合分数",
        "inputs": ["df_features", "df_trades", "df_financials", "metadata", "weights"],
        "outputs": ["score (0-100)", "breakdown (dict)"]
      },
      "detect_institutional_exodus": {
        "description": "检测机构大举撤离",
        "inputs": ["df_trades", "current_date"],
        "outputs": ["bool"]
      },
      "check_earnings_risk": {
        "description": "检查财报临近风险",
        "inputs": ["metadata", "current_date"],
        "outputs": ["has_risk (bool)", "days_until (int)"]
      },
      "detect_trend_breakdown": {
        "description": "检测技术趋势破坏",
        "inputs": ["df_features"],
        "outputs": ["breakdown_description (str or None)"]
      },
      "detect_market_deterioration": {
        "description": "检测市场恶化",
        "inputs": ["df_features", "entry_date", "current_date"],
        "outputs": ["deterioration_description (str or None)"]
      }
    }
  },
  
  "backtest_performance_reference": {
    "description": "现有策略在8306股票上的回测表现（2021-01-01至2026-01-08）",
    "test_stock": "8306",
    "test_period": "2021-01-01 to 2026-01-08",
    
    "top_performers": [
      {
        "combination": "EnhancedScorer × ScoreBased",
        "total_return": "147.41%",
        "sharpe_ratio": 10.57,
        "win_rate": "66.7%",
        "trades": 3
      },
      {
        "combination": "SimpleScorer × ScoreBased",
        "total_return": "132.76%",
        "sharpe_ratio": 7.70,
        "win_rate": "50.0%",
        "trades": 4
      },
      {
        "combination": "EnhancedScorer × ATR",
        "total_return": "95.87%",
        "sharpe_ratio": 6.54,
        "win_rate": "53.3%",
        "trades": 15
      }
    ]
  },
  
  "design_principles": {
    "signal_timing": "T日收盘后生成信号，T+1日开盘价执行",
    "no_future_peeking": "严格使用当日及之前的数据",
    "lot_size_compliance": "遵守日本股市最小购买单位规则",
    "risk_management": "多层止损和风险控制",
    "modular_architecture": "入场和出场策略独立组合"
  },
  
  "extension_opportunities": {
    "suggested_areas": [
      "基于机器学习的入场策略",
      "期权Greeks启发的动态止损",
      "市场情绪指标（VIX、Put/Call Ratio）",
      "板块轮动策略",
      "基于宏观经济指标的过滤器",
      "自适应参数优化",
      "多时间周期协同策略"
    ],
    
    "data_constraints": [
      "必须使用JQuants API提供的数据字段",
      "日频数据为主，周频机构数据，季度财报数据",
      "避免使用未来信息"
    ]
  }
}
